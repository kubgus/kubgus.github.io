---
import BlogPreview from "../blog-preview.astro";

const posts = await Astro.glob("../../pages/blog/*/*.md");
// TODO: Hook this up to the Twitter API
posts.sort((a, b) => new Date(b.frontmatter.date).valueOf() - new Date(a.frontmatter.date).valueOf());
---

<h2>Newsletter</h2>

<!-- TODO: Make this a sticky popup -->
<section id="newsletter">
    <p>
        I have a newsletter, btw! I post regular updates on my work, exclusive
        guides, and Patreon member articles for free.
    </p>

    <a href="/newsletter" class="btn">Subscribe</a>
</section>

<h2>Blog Posts</h2>
{
    posts.map((post) => (
        <BlogPreview url={post.url} frontmatter={post.frontmatter} />
    ))
}

<style>
    #newsletter > *:not(:last-child) {
        margin-bottom: 1.1rem;
    }
</style>
