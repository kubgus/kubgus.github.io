---
import BlogPreview from "../blog-preview.astro";

const posts = await Astro.glob("../../pages/blog/*/*.md");
// TODO: Hook this up to the Twitter API
posts.sort((a, b) => new Date(b.frontmatter.date).valueOf() - new Date(a.frontmatter.date).valueOf());
---

<div class="content-inner">
    <h1>Newsletter</h1>

    <!-- TODO: Make this a sticky popup -->
    <section id="newsletter">
        <p>
            I have a newsletter, btw! I post regular updates on my work, exclusive
            guides, and Patreon member articles for free.
        </p>

        <a href="/join" class="btn">Subscribe</a>
    </section>

    <h1>Blog Posts</h1>
    {
        posts.map((post) => (
            <BlogPreview url={post.url} frontmatter={post.frontmatter} />
        ))
    }
</div>

<style>
    #newsletter > *:not(:last-child) {
        margin-bottom: 1.1rem;
    }
</style>
